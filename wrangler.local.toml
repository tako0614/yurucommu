# Local development configuration for workerd
# Run with: wrangler dev --config wrangler.local.toml

name = "yurucommu-local"
main = "src/backend/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat", "global_fetch_strictly_public"]

[vars]
APP_URL = "http://localhost:8787"

# Local D1 Database (SQLite)
[[d1_databases]]
binding = "DB"
database_name = "yurucommu-local"
database_id = "local"
migrations_dir = "migrations"

# Local R2 Bucket (filesystem-backed)
[[r2_buckets]]
binding = "MEDIA"
bucket_name = "yurucommu-local-media"

# Local KV Namespace
[[kv_namespaces]]
binding = "KV"
id = "local-kv"

# Static assets
[assets]
directory = "./dist"
binding = "ASSETS"
run_worker_first = true
not_found_handling = "single-page-application"
